/*! responsiveCarousel.JS - v1.2.0
 * http://basilio.github.com/responsiveCarousel
 *
 * Copyright (c) 2013 Basilio C\u00e1ceres <basilio.caceres@gmail.com>;
 * Licensed under the MIT license */
(function(n){"use strict";n.fn.rpcarousel=function(t){var r,i;return r={infinite:!0,visible:1,speed:"fast",overflow:!1,autoRotate:!1,navigation:n(this).data("navigation"),itemMinWidth:0,itemEqualHeight:!1,itemMargin:0,itemClassActive:"crsl-active",imageWideClass:"wide-image",carousel:!0},n(this).each(function(){var u,f,e;i=n(this);n.isEmptyObject(t)===!1&&n.extend(r,t);n.isEmptyObject(n(i).data("crsl"))===!1&&n.extend(r,n(i).data("crsl"));r.isTouch="ontouchstart"in document.documentElement||navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)?!0:!1;i.init=function(){r.total=n(i).find(".crsl-item").length;r.itemWidth=n(i).outerWidth();r.visibleDefault=r.visible;r.swipeDistance=null;r.swipeMinDistance=100;r.startCoords={};r.endCoords={};n(i).css({width:"100%"});n(i).find(".crsl-item").css({position:"relative",float:"left",overflow:"hidden",height:"auto"});n(i).find("."+r.imageWideClass).each(function(){n(this).css({display:"block",width:"100%",height:"auto"})});n(i).find(".crsl-item iframe").attr({width:"100%"});r.carousel&&n(i).find(".crsl-item:first-child").addClass(r.itemClassActive);r.carousel&&r.infinite&&r.visible<r.total&&n(i).find(".crsl-item:first-child").before(n(".crsl-item:last-child",i));r.overflow===!1?n(i).css({overflow:"hidden"}):n("html, body").css({"overflow-x":"hidden"});n(i).trigger("initCarousel",[r,i]);i.testPreload();i.config();i.initRotate();i.triggerNavs()};i.testPreload=function(){if(n(i).find("img").length>0){var u=n(i).find("img").length,t=1;n(i).find("img").each(function(){i.preloadImage(this,t,u);t++})}else n(i).trigger("loadedCarousel",[r,i])};i.preloadImage=function(t,u,f){var o=new Image,e={};e.src=n(t).attr("src")!==undefined?t.src:"";e.alt=n(t).attr("alt")!==undefined?t.alt:"";n(o).attr(e);n(o).on("load",function(){u===1&&n(i).trigger("loadingImagesCarousel",[r,i]);u===f&&n(i).trigger("loadedImagesCarousel",[r,i])})};i.config=function(){r.itemWidth=Math.floor((n(i).outerWidth()-r.itemMargin*(r.visibleDefault-1))/r.visibleDefault);r.itemWidth<=r.itemMinWidth?(r.visible=Math.floor((n(i).outerWidth()-r.itemMargin*(r.visible-1))/r.itemMinWidth)===1?Math.floor(n(i).outerWidth()/r.itemMinWidth):Math.floor((n(i).outerWidth()-r.itemMargin)/r.itemMinWidth),r.visible=r.visible<1?1:r.visible,r.itemWidth=r.visible===1?Math.floor(n(i).outerWidth()):Math.floor((n(i).outerWidth()-r.itemMargin*(r.visible-1))/r.visible)):r.visible=r.visibleDefault;r.carousel?(i.wrapWidth=Math.floor((r.itemWidth+r.itemMargin)*r.total),i.wrapMargin=i.wrapMarginDefault=r.infinite&&r.visible<r.total?parseInt((r.itemWidth+r.itemMargin)*-1,10):0,r.infinite&&r.visible<r.total&&n(i).find(".crsl-item."+r.itemClassActive).index()===0&&(n(i).find(".crsl-item:first-child").before(n(".crsl-item:last-child",i)),i.wrapMargin=i.wrapMarginDefault=parseInt((r.itemWidth+r.itemMargin)*-1,10)),n(i).find(".crsl-wrap").css({width:i.wrapWidth+"px",marginLeft:i.wrapMargin})):(i.wrapWidth=n(i).outerWidth(),n(i).find(".crsl-wrap").css({width:i.wrapWidth+r.itemMargin+"px"}),n("#"+r.navigation).hide());n(i).find(".crsl-item").css({width:r.itemWidth+"px",marginRight:r.itemMargin+"px"});i.equalHeights();r.carousel&&(r.visible>=r.total?(r.autoRotate=!1,n("#"+r.navigation).hide()):n("#"+r.navigation).show())};i.equalHeights=function(){if(r.itemEqualHeight!==!1){var t=0;n(i).find(".crsl-item").each(function(){n(this).css({height:"auto"});n(this).outerHeight()>t&&(t=n(this).outerHeight())});n(i).find(".crsl-item").css({height:t+"px"})}return!0};i.initRotate=function(){r.autoRotate!==!1&&(i.rotateTime=window.setInterval(function(){i.rotate()},r.autoRotate))};i.triggerNavs=function(){n("#"+r.navigation).delegate(".previous, .next","click",function(t){if(t.preventDefault(),i.prepareExecute(),n(this).hasClass("previous")&&i.testPrevious(i.itemActive))i.previous();else if(n(this).hasClass("next")&&i.testNext())i.next();else return})};i.prepareExecute=function(){return r.autoRotate&&clearInterval(i.rotateTime),i.preventAnimateEvent(),i.itemActive=n(i).find(".crsl-item."+r.itemClassActive),!0};i.preventAnimateEvent=function(){if(n(i).find(".crsl-wrap:animated").length>0)return!1};i.rotate=function(){return i.preventAnimateEvent(),i.itemActive=n(i).find(".crsl-item."+r.itemClassActive),i.next(),!0};i.testPrevious=function(t){return n(".crsl-wrap",i).find(".crsl-item").index(t)>0};i.testNext=function(){return!r.infinite&&i.wrapWidth>=(r.itemWidth+r.itemMargin)*(r.visible+1)-i.wrapMargin||r.infinite};i.previous=function(){i.wrapMargin=r.infinite?i.wrapMarginDefault+n(i.itemActive).outerWidth(!0):i.wrapMargin+n(i.itemActive).outerWidth(!0);var f=n(i.itemActive).index(),t=n(i.itemActive).prev(".crsl-item"),u="previous";n(i).trigger("beginCarousel",[r,i,u]);n(i).find(".crsl-wrap").animate({marginLeft:i.wrapMargin+"px"},r.speed,function(){n(i.itemActive).removeClass(r.itemClassActive);n(t).addClass(r.itemClassActive);r.infinite?n(this).css({marginLeft:i.wrapMarginDefault}).find(".crsl-item:first-child").before(n(".crsl-item:last-child",i)):(i.testPrevious(t)===!1&&n("#"+r.navigation).find(".previous").addClass("previous-inactive"),i.testNext()&&n("#"+r.navigation).find(".next").removeClass("next-inactive"));n(this).trigger("endCarousel",[r,i,u])})};i.next=function(){i.wrapMargin=r.infinite?i.wrapMarginDefault-n(i.itemActive).outerWidth(!0):i.wrapMargin-n(i.itemActive).outerWidth(!0);var f=n(i.itemActive).index(),t=n(i.itemActive).next(".crsl-item"),u="next";n(i).trigger("beginCarousel",[r,i,u]);n(i).find(".crsl-wrap").animate({marginLeft:i.wrapMargin+"px"},r.speed,function(){n(i.itemActive).removeClass(r.itemClassActive);n(t).addClass(r.itemClassActive);r.infinite?n(this).css({marginLeft:i.wrapMarginDefault}).find(".crsl-item:last-child").after(n(".crsl-item:first-child",i)):(i.testPrevious(t)&&n("#"+r.navigation).find(".previous").removeClass("previous-inactive"),i.testNext()===!1&&n("#"+r.navigation).find(".next").addClass("next-inactive"));n(this).trigger("endCarousel",[r,i,u])})};u=!1;n(window).on("mouseleave",function(t){return t.target?f=t.target:t.srcElement&&(f=t.srcElement),u=n(i).attr("id")&&n(f).parents(".crsl-items").attr("id")===n(i).attr("id")||n(f).parents(".crsl-items").data("navigation")===n(i).data("navigation")?!0:!1,!1});n(window).on("keydown",function(n){u===!0&&(n.keyCode===37?(i.prepareExecute(),i.previous()):n.keyCode===39&&(i.prepareExecute(),i.next()));return});if(r.isTouch){e=!1;n(i).on("touchstart",function(t){e=!1;n(i).addClass("touching");r.startCoords.pageX=r.endCoords.pageX=t.originalEvent.targetTouches[0].pageX;r.startCoords.pageY=r.endCoords.pageY=t.originalEvent.targetTouches[0].pageY;n(".touching").on("touchmove",function(n){r.endCoords.pageX=n.originalEvent.targetTouches[0].pageX;r.endCoords.pageY=n.originalEvent.targetTouches[0].pageY;Math.abs(parseInt(r.endCoords.pageX-r.startCoords.pageX,10))>Math.abs(parseInt(r.endCoords.pageY-r.startCoords.pageY,10))&&(e=!0,n.preventDefault(),n.stopPropagation())})}).on("touchend",function(t){e&&(t.preventDefault(),t.stopPropagation(),r.swipeDistance=r.endCoords.pageX-r.startCoords.pageX,r.swipeDistance>=r.swipeMinDistance?i.previous():r.swipeDistance<=-r.swipeMinDistance&&i.next());n(".touching").off("touchmove").removeClass("touching")})}n(i).on("loadedCarousel loadedImagesCarousel",function(){i.equalHeights()});n(window).on("carouselResizeEnd",function(){r.itemWidth!==n(i).outerWidth()&&i.config()});n(window).ready(function(){n(i).trigger("prepareCarousel",[r,i]);i.init();n(window).on("resize",function(){this.carouselResizeTo&&clearTimeout(this.carouselResizeTo);this.carouselResizeTo=setTimeout(function(){n(this).trigger("carouselResizeEnd")},10)})});n(window).load(function(){i.testPreload();i.config()})})}})(jQuery);