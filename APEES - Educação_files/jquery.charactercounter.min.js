(function(n){var t=function(n,t){this.options=null;this.$inputElement=null;this.$counterElement=null;this.init(n,t)};t.DEFAULTS={elementClass:"me-character-counter",validClass:"me-character-counter_valid",invalidClass:"me-character-counter_invalid",maxChars:Infinity,minChars:0,counterElement:null,positiveOverruns:!1,newLinesAsTwoChars:!0,postCountMessage:null,preCountMessage:null,postCountMessageSingular:null,preCountMessageSingular:null,zeroRemainingMessage:null,overrunPostCountMessage:null,overrunPreCountMessage:null,overrunPostCountMessageSingular:null,overrunPreCountMessageSingular:null};t.prototype.init=function(i,r){this.$inputElement=n(i);this.options=n.extend({},t.DEFAULTS,r,this.getDataOptions());this.options.counterElement===null?(this.$counterElement=n(document.createElement("div")),this.$inputElement.after(this.$counterElement)):this.$counterElement=n(this.options.counterElement);this.$counterElement.addClass(this.options.elementClass);this._onInput();var u=this.getEventNames().join(" ");this.$inputElement.bind(u,n.proxy(this._onInput,this))};t.prototype.getEventNames=function(){var n=["change","keyup"];return"oninput"in document.createElement("input")&&n.push("input"),n};t.prototype.getDataOptions=function(){for(var r,i=Object.keys(t.DEFAULTS),u={},n=0;n<i.length;n++)r=this.$inputElement.data(i[n]),typeof r!="undefined"&&(u[i[n]]=r);return u};t.prototype.countCharactersUsed=function(){var n=this.$inputElement.val(),r=n.length,t=n.match(/(\r\n|\n|\r)/g),i=0;return t!=null&&(i=t.length),r+i};t.prototype._onInput=function(){var n=this.countCharactersUsed(),t=this.options.maxChars-n,i=t>=0&&n>=this.options.minChars,r=this.calculateMessage(n,t);this.setText(r);this.setValidityClass(i)};t.prototype.calculateMessage=function(n,t){var r="",i="";return t===0&&this.options.zeroRemainingMessage!==null?this.options.zeroRemainingMessage:(t>=0&&this.options.preCountMessage!==null?(r=this.options.preCountMessage,t===1&&this.options.preCountMessageSingular!==null&&(r=this.options.preCountMessageSingular)):t<0&&this.options.overrunPreCountMessage!==null&&(r=this.options.overrunPreCountMessage,t===-1&&this.options.overrunPreCountMessageSingular!==null&&(r=this.options.overrunPreCountMessageSingular)),t>=0&&this.options.postCountMessage!==null?(i=this.options.postCountMessage,t===1&&this.options.postCountMessageSingular!==null&&(i=this.options.postCountMessageSingular)):t<0&&this.options.overrunPostCountMessage!==null&&(i=this.options.overrunPostCountMessage,t===-1&&this.options.overrunPostCountMessageSingular!==null&&(i=this.options.overrunPostCountMessageSingular)),t<0&&this.options.positiveOverruns&&(t*=-1),r.length>0&&(r+=" "),i.length>0&&(i=" "+i),r+t+i)};t.prototype.setText=function(n){this.$counterElement.text(n)};t.prototype.setValidityClass=function(n){n?this.$counterElement.addClass(this.options.validClass).removeClass(this.options.invalidClass):this.$counterElement.addClass(this.options.invalidClass).removeClass(this.options.validClass)};n.fn.characterCounter=function(i){return this.each(function(){var u=n(this),r=u.data("markembling.characterCounter"),f;r||(f=typeof i=="object"&&i,r=new t(this,f),u.data("markembling.characterCounter",r));typeof i=="string"&&r[i]()})}})(jQuery);